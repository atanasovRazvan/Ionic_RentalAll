[{"C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\index.tsx":"1","C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\serviceWorker.ts":"2","C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\App.tsx":"3","C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\todo\\ItemProvider.tsx":"4","C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\todo\\index.tsx":"5","C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\auth\\index.tsx":"6","C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\todo\\itemApi.tsx":"7","C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\auth\\AuthProvider.tsx":"8","C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\todo\\ItemEdit.tsx":"9","C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\todo\\ItemList.tsx":"10","C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\auth\\PrivateRoute.tsx":"11","C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\auth\\Login.tsx":"12","C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\core\\index.tsx":"13","C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\todo\\Item.tsx":"14","C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\auth\\AuthApi.tsx":"15"},{"size":430,"mtime":1604492964841,"results":"16","hashOfConfig":"17"},{"size":5213,"mtime":1600535081000,"results":"18","hashOfConfig":"17"},{"size":1617,"mtime":1607590366343,"results":"19","hashOfConfig":"17"},{"size":8769,"mtime":1607623291064,"results":"20","hashOfConfig":"17"},{"size":100,"mtime":1607590345370,"results":"21","hashOfConfig":"17"},{"size":92,"mtime":1606837537310,"results":"22","hashOfConfig":"17"},{"size":2163,"mtime":1607613560730,"results":"23","hashOfConfig":"17"},{"size":3661,"mtime":1607378297464,"results":"24","hashOfConfig":"17"},{"size":3195,"mtime":1607613116584,"results":"25","hashOfConfig":"17"},{"size":6678,"mtime":1607623777299,"results":"26","hashOfConfig":"17"},{"size":832,"mtime":1607032283888,"results":"27","hashOfConfig":"17"},{"size":1795,"mtime":1607032285590,"results":"28","hashOfConfig":"17"},{"size":814,"mtime":1606870206159,"results":"29","hashOfConfig":"17"},{"size":1132,"mtime":1607623289385,"results":"30","hashOfConfig":"17"},{"size":385,"mtime":1606947981300,"results":"31","hashOfConfig":"17"},{"filePath":"32","messages":"33","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"34"},"1ecb3n0",{"filePath":"35","messages":"36","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"34"},{"filePath":"37","messages":"38","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"34"},{"filePath":"39","messages":"40","errorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":1,"source":"41","usedDeprecatedRules":"34"},{"filePath":"42","messages":"43","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"34"},{"filePath":"44","messages":"45","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"34"},{"filePath":"46","messages":"47","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"34"},{"filePath":"48","messages":"49","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"50","usedDeprecatedRules":"34"},{"filePath":"51","messages":"52","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"53","usedDeprecatedRules":"34"},{"filePath":"54","messages":"55","errorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"56","usedDeprecatedRules":"34"},{"filePath":"57","messages":"58","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"34"},{"filePath":"59","messages":"60","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"34"},{"filePath":"61","messages":"62","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"34"},{"filePath":"63","messages":"64","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"34"},{"filePath":"65","messages":"66","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"67"},"C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\index.tsx",[],["68","69"],"C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\serviceWorker.ts",[],"C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\App.tsx",[],"C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\todo\\ItemProvider.tsx",["70","71","72","73"],"import React, { useCallback, useEffect, useReducer, useContext } from 'react';\nimport PropTypes from 'prop-types';\nimport { getLogger } from '../core';\nimport { ItemProps } from './ItemProps';\nimport { createItem, deleteITEM, getItem, getItems, newWebSocket, updateItem } from './itemApi';\nimport { Plugins } from '@capacitor/core';\nimport { AuthContext } from '../auth';\n\nconst { Network } = Plugins;\nconst {Storage} = Plugins;\n\nconst log = getLogger('ItemProvider');\n\ntype SaveItemFn = (item: ItemProps) => Promise<any>;\ntype DeleteItemFn = (id?: String) => Promise<any>;\n\nexport interface ItemsState {\n  items?: ItemProps[],\n  conflictualItems?: ItemProps[],\n  fetching: boolean,\n  fetchingError?: Error | null,\n  saving: boolean,\n  deleting: boolean,\n  deletingError?: Error | null,\n  savingError?: Error | null,\n  savingPending: boolean,\n  saveItem?: SaveItemFn,\n  deleteItem?: DeleteItemFn,\n}\n\ninterface ActionProps {\n  type: string,\n  payload?: any,\n}\n\nconst initialState: ItemsState = {\n  fetching: false,\n  saving: false,\n  deleting: false,\n  savingPending: false\n};\n\nconst FETCH_ITEMS_STARTED = 'FETCH_ITEMS_STARTED';\nconst FETCH_ITEMS_SUCCEEDED = 'FETCH_ITEMS_SUCCEEDED';\nconst FETCH_ITEMS_FAILED = 'FETCH_ITEMS_FAILED';\nconst SAVE_ITEM_STARTED = 'SAVE_ITEM_STARTED';\nconst SAVE_ITEM_SUCCEEDED = 'SAVE_ITEM_SUCCEEDED';\nconst SAVE_ITEM_FAILED = 'SAVE_ITEM_FAILED';\nconst DELETE_ITEM_STARTED = 'DELETE_ITEM_STARTED';\nconst DELETE_ITEM_SUCCEEDED = 'DELETE_ITEM_SUCCEDED';\nconst DELETE_ITEM_FAILED = 'DELETE_ITEM_FAILED';\nconst SAVING_PENDING = 'SAVING_PENDING';\n\nlet idOfDeleted : String | undefined;\n\nconst reducer: (state: ItemsState, action: ActionProps) => ItemsState =\n  (state, { type, payload }) => {\n    switch (type) {\n      case FETCH_ITEMS_STARTED:\n        return { ...state, fetching: true, fetchingError: null };\n      case FETCH_ITEMS_SUCCEEDED:\n        return { ...state, items: payload.items, fetching: false };\n      case FETCH_ITEMS_FAILED:\n        return { ...state, items: payload.items, fetchingError: payload.error, fetching: false };\n      case SAVE_ITEM_STARTED:\n        return { ...state, savingError: null, saving: true };\n      case SAVE_ITEM_SUCCEEDED:{\n        const items = [...(state.items || [])];\n        const item = payload.item;\n        const index = items.findIndex(it => it.id === item.id);\n        if (index === -1) {\n          items.splice(0, 0, item);\n        } else {\n          items[index] = item;\n        }\n        return { ...state, items, saving: false, savingPending: false };\n      }\n      case SAVE_ITEM_FAILED:{\n        const items = [...(state.items || [])];\n        const item = payload.item;\n        item.status = false;\n        const index = items.findIndex(it => it.id === item.id);\n        if (index === -1) {\n          items.splice(0, 0, item);\n        } else {\n          items[index] = item;\n        }\n        return { ...state, items, savingError: payload.error, saving: false, savingPending: false };\n      }\n      case SAVING_PENDING:{\n        return { ...state, conflictualItems: payload.conflictualItems, savingPending: true};\n      }\n      case DELETE_ITEM_STARTED:\n        return { ...state, deletingError: null, deleting: true}\n      case DELETE_ITEM_SUCCEEDED:{\n        const items = [...(state.items || [])];\n        const index = items.findIndex(it => it.id === idOfDeleted)\n        log(idOfDeleted)\n        if(index !== -1){\n          items.splice(index, 1)\n        }\n        return { ...state, items, deleting: false };\n      }\n      case DELETE_ITEM_FAILED:\n        return { ...state, deletingError: payload.error, deleting: false };\n      default:\n        return state;\n    }\n  };\n\nexport const ItemContext = React.createContext<ItemsState>(initialState);\n\ninterface ItemProviderProps {\n  children: PropTypes.ReactNodeLike,\n}\n\nexport const ItemProvider: React.FC<ItemProviderProps> = ({ children }) => {\n\n  const { token } = useContext(AuthContext);\n  const [state, dispatch] = useReducer(reducer, initialState);\n  const { items, conflictualItems, fetching, fetchingError, saving, savingPending, deleting, savingError } = state;\n  useEffect(getItemsEffect, [token]);\n  useEffect(networkStatusEffect, []);\n  useEffect(wsEffect, [token]);\n  const saveItem = useCallback<SaveItemFn>(saveItemCallback, [token]);\n  const deleteItem = useCallback<DeleteItemFn>(deleteItemCallback, [token]);\n  const value = { items, conflictualItems, fetching, fetchingError, saving, savingPending, deleting, savingError, saveItem, deleteItem };\n  log('returns');\n  return (\n    <ItemContext.Provider value={value}>\n      {children}\n    </ItemContext.Provider>\n  );\n\n  function networkStatusEffect() {\n    Network.addListener(\"networkStatusChange\", status => {\n      log(\"Network status changed: \", status);\n\n      tryToUpdateItems();\n\n    async function tryToUpdateItems() {\n      const status = await Network.getStatus();\n      if(status.connected === true){\n        const { keys } = await Storage.keys();\n        for(let i = 0; i < keys.length; i ++)\n          if(keys[i].startsWith(\"item_save\")){\n            const toUpdate = await Storage.get({key: keys[i]});\n            const toUpdateItem = JSON.parse(toUpdate.value || '{}');\n            toUpdateItem.id = keys[i].split(\"save\")[1];\n\n            const existingItem = await getItem(toUpdateItem.id);\n            if(existingItem.version !== toUpdateItem.version + 1){\n              saveItemCallback(toUpdateItem);\n            }\n            else{\n              toUpdateItem.id = toUpdateItem.id + \"_1\";\n              existingItem.id = existingItem.id + \"_2\";\n              const conflictualItems = [toUpdateItem, existingItem];\n              dispatch({type: SAVING_PENDING, payload: { conflictualItems }});\n            }\n            await Storage.remove({key: keys[i]});\n          }\n      }\n    }\n\n    })\n  }\n\n  function getItemsEffect() {\n    let canceled = false;\n    fetchItems();\n    return () => {\n      canceled = true;\n    }\n\n    async function fetchItems() {\n      if(!token?.trim()){\n        return;\n      }\n      try {\n        log('fetchItems started');\n        dispatch({ type: FETCH_ITEMS_STARTED });\n        const items = await getItems((await Storage.get({key: 'token'})).value);\n\n        log('fetchItems succeeded');\n        if (!canceled) {\n          dispatch({ type: FETCH_ITEMS_SUCCEEDED, payload: { items } });\n        }\n\n        let allItems = {...items};\n\n        for(let i = 0; i < items.length; i ++)\n          await Storage.set({\n            key: \"item\" + allItems[i].id,\n            value: JSON.stringify({\n              description: allItems[i].description,\n              price: allItems[i].price,\n              priceEstimation: allItems[i].priceEstimation,\n              ownerUsername: allItems[i].ownerUsername,\n              version: allItems[i].version,\n              status: true\n            })\n          });\n\n      } catch (error) {\n        log('fetchItems failed');\n        \n        const { keys } = await Storage.keys();\n        let allItems = new Array();\n\n        for(let i = 0; i < keys.length; i ++)\n          if(keys[i] !== 'token'){\n            const ret = await Storage.get({key: keys[i]});\n            const result = JSON.parse(ret.value || '{}');\n            allItems.push(result)\n          }\n\n        const items = allItems;\n\n        dispatch({ type: FETCH_ITEMS_FAILED, payload: { items, error } });\n\n      }\n    }\n  }\n\n  async function saveItemCallback(item: ItemProps) {\n    try {\n      log('saveItem started');\n      dispatch({ type: SAVE_ITEM_STARTED });\n      const savedItem = await (item.id ? updateItem(item) : createItem(item));\n      log('saveItem succeeded');\n      dispatch({ type: SAVE_ITEM_SUCCEEDED, payload: { item: savedItem }, });\n    } catch (error) {\n      log('saveItem failed');\n      dispatch({ type: SAVE_ITEM_FAILED, payload: { item, error } });\n    }\n  }\n\n  async function deleteItemCallback(id?: String){\n    try{\n      log('deleteItem started');\n      dispatch({type: DELETE_ITEM_STARTED});\n      const deletedItem = await (deleteITEM(id));\n      idOfDeleted = id;\n      dispatch({type: DELETE_ITEM_SUCCEEDED})\n      log('deleteItem succeeded');\n    }catch(error){\n      log('deleteItem failed');\n      dispatch({type: DELETE_ITEM_FAILED});\n    }\n  }\n\n  function wsEffect() {\n    let canceled = false;\n    log('wsEffect - connecting');\n    const closeWebSocket = newWebSocket(message => {\n      if (canceled) {\n        return;\n      }\n      const { event, payload: { item }} = message;\n      log(`ws message, item ${event}`);\n      if (event === 'created' || event === 'updated') {\n        dispatch({ type: SAVE_ITEM_SUCCEEDED, payload: { item } });\n      }\n    });\n    return () => {\n      log('wsEffect - disconnecting');\n      canceled = true;\n      closeWebSocket();\n    }\n  }\n};\n","C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\todo\\index.tsx",[],"C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\auth\\index.tsx",[],"C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\todo\\itemApi.tsx",[],"C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\auth\\AuthProvider.tsx",["74","75","76"],"import React, { useCallback, useEffect, useState } from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport { getLogger } from '../core';\r\nimport { login as loginApi } from './AuthApi';\r\nimport { Plugins } from '@capacitor/core';\r\n\r\nconst log = getLogger('AuthProvider');\r\n\r\ntype LoginFn = (username?: string, password?: string) => void;\r\ntype LogoutFn = () => void;\r\n\r\nconst { Storage } = Plugins;\r\n\r\nexport interface AuthState {\r\n  authenticationError: Error | null;\r\n  isAuthenticated: boolean;\r\n  isAuthenticating: boolean;\r\n  login?: LoginFn;\r\n  logout?: LogoutFn;\r\n  pendingAuthentication?: boolean;\r\n  username?: string;\r\n  password?: string;\r\n  token: string;\r\n}\r\n\r\nconst initialState: AuthState = {\r\n  isAuthenticated: false,\r\n  isAuthenticating: false,\r\n  authenticationError: null,\r\n  pendingAuthentication: false,\r\n  token: \"\",\r\n};\r\n\r\nexport const AuthContext = React.createContext<AuthState>(initialState);\r\n\r\ninterface AuthProviderProps {\r\n  children: PropTypes.ReactNodeLike,\r\n}\r\n\r\nexport const AuthProvider: React.FC<AuthProviderProps> = ({ children }) => {\r\n  const [state, setState] = useState<AuthState>(initialState);\r\n  const { isAuthenticated, isAuthenticating, authenticationError, pendingAuthentication, token } = state;\r\n  const login = useCallback<LoginFn>(loginCallback, []);\r\n  const logout = useCallback<LogoutFn>(logoutCallBack, []);\r\n  useEffect(authenticationEffect, [pendingAuthentication]);\r\n  const value = { isAuthenticated, login, logout, isAuthenticating, authenticationError, token };\r\n  log('render');\r\n  return (\r\n    <AuthContext.Provider value={value}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n\r\n  function loginCallback(username?: string, password?: string): void {\r\n    log('login');\r\n    setState({\r\n      ...state,\r\n      pendingAuthentication: true,\r\n      username,\r\n      password\r\n    });\r\n  }\r\n\r\n  function logoutCallBack(): void {\r\n    log(\"logout\");\r\n    setState({\r\n      ...state,\r\n      isAuthenticated: false,\r\n      token:\"\",\r\n\r\n    });\r\n    (async () =>{\r\n      await Storage.clear();\r\n    })();\r\n  }\r\n\r\n  function authenticationEffect() {\r\n    let canceled = false;\r\n    authenticate();\r\n    return () => {\r\n      canceled = true;\r\n    }\r\n\r\n    async function authenticate() {\r\n\r\n      var tokenStorage = await Storage.get({key: \"token\"});\r\n      if (tokenStorage.value) {\r\n        setState({\r\n            ...state,\r\n            token: tokenStorage.value,\r\n            pendingAuthentication: false,\r\n            isAuthenticated: true,\r\n            isAuthenticating: false,\r\n        });\r\n      }\r\n\r\n      if (!pendingAuthentication) {\r\n        log('authenticate, !pendingAuthentication, return');\r\n        return;\r\n      }\r\n      try {\r\n        log('authenticate...');\r\n        setState({\r\n          ...state,\r\n          isAuthenticating: true,\r\n        });\r\n        const { username, password } = state;\r\n        const { token } = await loginApi(username, password);\r\n        console.log(token);\r\n\r\n        if (canceled) {\r\n          return;\r\n        }\r\n        log('authenticate succeeded');\r\n\r\n        await Storage.set({\r\n          key: 'token',\r\n          value: token \r\n        });\r\n\r\n        setState({\r\n          ...state,\r\n          token,\r\n          pendingAuthentication: false,\r\n          isAuthenticated: true,\r\n          isAuthenticating: false,\r\n        });\r\n      } catch (error) {\r\n        if (canceled) {\r\n          return;\r\n        }\r\n        log('authenticate failed');\r\n        setState({\r\n          ...state,\r\n          authenticationError: error,\r\n          pendingAuthentication: false,\r\n          isAuthenticating: false,\r\n        });\r\n      }\r\n    }\r\n  }\r\n};\r\n","C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\todo\\ItemEdit.tsx",["77","78"],"import React, { useContext, useEffect, useState } from 'react';\nimport {\n  IonButton,\n  IonButtons,\n  IonContent,\n  IonHeader,\n  IonInput,\n  IonLoading,\n  IonPage,\n  IonTitle,\n  IonToolbar,\n  IonLabel,\n  IonFab,\n  IonFabButton,\n  IonIcon\n} from '@ionic/react';\nimport { getLogger } from '../core';\nimport { ItemContext } from './ItemProvider';\nimport { RouteComponentProps } from 'react-router';\nimport { ItemProps } from './ItemProps';\nimport { trashBin } from 'ionicons/icons';\n\nconst log = getLogger('ItemEdit');\n\ninterface ItemEditProps extends RouteComponentProps<{\n  id?: string;\n}> {}\n\nconst ItemEdit: React.FC<ItemEditProps> = ({ history, match }) => {\n  const { items, saving, deleting, savingPending, savingError, saveItem, deleteItem } = useContext(ItemContext);\n  const [description, setDescription] = useState('');\n  const [price, setPrice] = useState('');\n  const [priceEstimation, setPriceEstimation] = useState('');\n  const [ownerUsername, setOwner] = useState('');\n  const [version, setVersion] = useState(0);\n  const [status, setStatus] = useState(true);\n  const [item, setItem] = useState<ItemProps>();\n  useEffect(() => {\n    log('useEffect');\n    const routeId = match.params.id || '';\n    const item = items?.find(it => it.id === routeId);\n    setItem(item);\n    if (item) {\n      setDescription(item.description);\n      setPrice(item.price);\n      setPriceEstimation(item.priceEstimation);\n      setOwner(item.ownerUsername);\n      setVersion(item.version);\n      setStatus(item.status);\n    }\n  }, [match.params.id, items]);\n  const handleSave = () => {\n    const editedItem = item ? { ...item, description, price, priceEstimation, ownerUsername, version, status } : { description, price, priceEstimation, ownerUsername, version, status };\n    saveItem && saveItem(editedItem).then(() => history.goBack());\n  };\n  const handleDelete = () => {\n    deleteItem && deleteItem(item?.id).then(() => history.goBack());\n  }\n  log('render');\n  \n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar>\n          <IonTitle>Edit</IonTitle>\n          <IonButtons slot=\"end\">\n            <IonButton onClick={handleSave}>\n              Save\n            </IonButton>\n          </IonButtons>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n          <IonLabel>Description: </IonLabel><IonInput value={description} onIonChange={e => setDescription(e.detail.value || '')} />\n          <IonLabel>Price: </IonLabel><IonInput value={price} onIonChange={e => setPrice(e.detail.value || '')} />\n          <IonLabel>Estimated Price: </IonLabel><IonInput value={priceEstimation} onIonChange={e => setPriceEstimation(e.detail.value || '')} />\n          <IonLabel>Owner: </IonLabel><IonInput value={ownerUsername} onIonChange={e => setOwner(e.detail.value || '')} />\n        <IonLoading isOpen={saving} />\n        {savingError && (\n          <div>{savingError.message || 'Failed to save item'}</div>\n        )}\n\n        <IonFab vertical=\"bottom\" horizontal=\"end\" slot=\"fixed\">\n          <IonFabButton onClick={handleDelete}>\n            <IonIcon icon={trashBin} />\n          </IonFabButton>\n        </IonFab>\n\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default ItemEdit;\n","C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\todo\\ItemList.tsx",["79","80","81"],"import React, { useContext, useState, useEffect } from 'react';\nimport { RouteComponentProps, Redirect } from 'react-router';\nimport {\n  IonButton,\n  IonContent,\n  IonFab,\n  IonFabButton,\n  IonHeader,\n  IonIcon,\n  IonList, IonLoading,\n  IonPage,\n  IonTitle,\n  IonToolbar,\n  IonSearchbar,\n  IonItem,\n  IonSelect,\n  IonSelectOption,\n  IonLabel,\n  IonBadge\n} from '@ionic/react';\nimport { add } from 'ionicons/icons';\nimport Item from './Item';\nimport { getLogger } from '../core';\nimport { ItemContext } from './ItemProvider';\nimport { AuthContext } from '../auth'\nimport { IonInfiniteScroll, IonInfiniteScrollContent} from '@ionic/react';\nimport { ItemProps } from './ItemProps';\nimport { Network } from '@capacitor/core';\n\nconst log = getLogger('ItemList');\n\nlet NStatus = \"Online\";\n\nNetwork.addListener(\"networkStatusChange\", status => {\n  NStatus = status.connected === true ? \"Online\" : \"Offline\";\n  log(NStatus, \"in listener\");\n})\n\nconst ItemList: React.FC<RouteComponentProps> = ({ history }) => {\n\n  const [networkStatus, setNetworkStatus] = useState<string>(NStatus);\n  Network.addListener(\"networkStatusChange\", status => {\n    setNetworkStatus(status.connected === true ? \"Online\" : \"Offline\");\n    log(networkStatus, \"in listener\");\n  })\n\n  const { items, conflictualItems, fetching, fetchingError, savingPending, saveItem } = useContext(ItemContext);\n  const { logout } = useContext(AuthContext);\n\n  const[disableInfiniteScroll, setDisableInfiniteScroll] = useState<boolean>(false);\n  const[pos, setPos] = useState(5);\n  const[conflict, setConflict] = useState<boolean>(false);\n\n  const[filter, setFilter] = useState<string | undefined>(\"any price\");\n  const selectOptions = [\"<=500 EUR\", \">500 EUR\", \"any price\"];\n  const [searchText, setSearchText] = useState<string>(\"\");\n\n  const renderColor = () => {\n    return networkStatus === \"Online\" ? \"primary\" : \"danger\";\n  }\n\n  const renderStatus = () => {\n    return networkStatus;\n  }\n\n  useEffect(() => {\n    log(networkStatus, \"in useEffect()\");\n  }, [networkStatus]);\n\n  const networkStatusView = <IonBadge color = { renderColor() }>Network status: { renderStatus() }</IonBadge>\n\n  const [apartmentsShow, setApartmentsShow] = useState<ItemProps[]>([]);\n\n  const handleLogout = () => {\n    logout?.();\n    return <Redirect to={{pathname: \"/login\"}} />;\n  }\n\n  async function searchNext($event: CustomEvent<void>)\n    {\n      if(items && pos < items.length){\n        setApartmentsShow([...items.slice(0, 5+pos)]);\n        setPos(pos+5);\n      }\n      else{\n        setDisableInfiniteScroll(true);\n      }\n      log(\"items from\" + 0 + \"to \" + pos)\n      log(apartmentsShow)\n      await ($event.target as HTMLIonInfiniteScrollElement).complete();\n    }\n\n  log('render');\n\n  useEffect(() =>{\n    if(items?.length){\n      setApartmentsShow(items.slice(0, pos));\n    }\n  }, [items]);\n\n  //filter\n  useEffect(()=>{\n    if(filter && items){\n      if(filter === \"<=500 EUR\"){\n        setApartmentsShow(items.filter((item) => Number.parseInt(item.price) <= 500) );\n      }\n      else if(filter === \">500 EUR\"){\n        setApartmentsShow(items.filter((item) => Number.parseInt(item.price) > 500) );\n      }\n      else if(filter === \"any price\"){\n        setApartmentsShow(items);\n      }\n    }\n  }, [filter]);\n\n  //search\n  useEffect(()=>{\n    if(searchText === \"\" && items){\n      setApartmentsShow(items);\n\n    }\n    if(searchText && items){\n      setApartmentsShow(items.filter((item) => item.description.startsWith(searchText)));\n    }\n  },[searchText]);\n    \n  useEffect(() => {\n    if(savingPending === true){\n      setConflict(true);\n    }\n    else{\n      setConflict(false);\n    }\n  }, [savingPending]);\n\n  async function handleEdit(id : string | undefined) {\n    const item = conflictualItems?.find(it => it.id === id);\n    if(item && item.id){\n        console.log(item);\n        item.id = item.id.split('_')[0];\n        item.version = item.version+1;\n        console.log(item);\n        saveItem && saveItem(item);\n    }\n    return;\n\n  }\n\n  if(conflict === true){\n    return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar>\n          <IonTitle>Conflicts</IonTitle>\n        </IonToolbar>\n      </IonHeader>\n      <IonContent>\n          \n        <IonList>\n            {conflictualItems?.map((item: ItemProps) => \n                <Item key={item.id} id={item.id} description={item.description} \n                    price={item.price} priceEstimation={item.priceEstimation} ownerUsername={item.ownerUsername} \n                    version={item.version} status={item.status} onEdit = {id => handleEdit(id)}>\n                </Item>)}\n        </IonList>\n\n      </IonContent>\n    </IonPage>\n    )}\n\n  else\n  log(\"ITEMS: \", items);\n  return (\n    <IonPage>\n      <IonHeader>\n        <IonToolbar>\n          <IonButton slot=\"end\" onClick = {handleLogout}>Logout</IonButton>\n          <IonTitle>EasyRENT</IonTitle>\n          { networkStatusView }\n        </IonToolbar>\n        <IonSearchbar value={searchText} debounce={500} onIonChange={(e) => setSearchText(e.detail.value!)}/>\n\n        <IonItem>\n            <IonLabel>Filter products by rating</IonLabel>\n            <IonSelect value={filter} onIonChange={(e) => setFilter(e.detail.value)}>\n                {selectOptions.map((option) => (\n                <IonSelectOption key={option} value={option}>\n                    {option}\n                </IonSelectOption>\n                ))}\n            </IonSelect>\n        </IonItem>\n      </IonHeader>\n      <IonContent>\n\n        <IonLoading isOpen={fetching} message=\"Fetching items\" />\n        {items && apartmentsShow.map((item: ItemProps) => {\n            return(\n            <IonList>\n              <Item key={item.id} id={item.id} description={item.description} \n                price={item.price} priceEstimation={item.priceEstimation} ownerUsername={item.ownerUsername} \n                version={item.version} status={item.status} onEdit={id => history.push(`/item/${id}`)} />\n            </IonList>\n            );\n        })}\n\n        <IonInfiniteScroll threshold=\"75px\" disabled={disableInfiniteScroll} onIonInfinite={(e: CustomEvent<void>) => searchNext(e)}>\n            <IonInfiniteScrollContent loadingSpinner=\"bubbles\" loadingText=\"Loading for more items...\"/>\n        </IonInfiniteScroll>\n\n        {fetchingError && (\n          <div>{fetchingError.message || 'Failed to fetch items, showing in-memory saved items!'}</div>\n        )}\n        <IonFab vertical=\"bottom\" horizontal=\"end\" slot=\"fixed\">\n          <IonFabButton onClick={() => history.push('/item')}>\n            <IonIcon icon={add} />\n          </IonFabButton>\n        </IonFab>\n      </IonContent>\n    </IonPage>\n  );\n};\n\nexport default ItemList;\n","C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\auth\\PrivateRoute.tsx",[],"C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\auth\\Login.tsx",[],"C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\core\\index.tsx",[],"C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\todo\\Item.tsx",[],"C:\\Users\\Razvan\\Desktop\\Facultate\\Anul_3\\Mobile\\ionic_RentalApp\\src\\auth\\AuthApi.tsx",[],["82","83"],{"ruleId":"84","replacedBy":"85"},{"ruleId":"86","replacedBy":"87"},{"ruleId":"88","severity":1,"message":"89","line":125,"column":62,"nodeType":"90","endLine":125,"endColumn":69,"suggestions":"91"},{"ruleId":"88","severity":1,"message":"89","line":126,"column":68,"nodeType":"90","endLine":126,"endColumn":75,"suggestions":"92"},{"ruleId":"93","severity":1,"message":"94","line":209,"column":24,"nodeType":"95","messageId":"96","endLine":209,"endColumn":35,"fix":"97"},{"ruleId":"98","severity":1,"message":"99","line":243,"column":13,"nodeType":"100","messageId":"101","endLine":243,"endColumn":24},{"ruleId":"88","severity":1,"message":"102","line":43,"column":53,"nodeType":"90","endLine":43,"endColumn":55,"suggestions":"103"},{"ruleId":"88","severity":1,"message":"102","line":44,"column":56,"nodeType":"90","endLine":44,"endColumn":58,"suggestions":"104"},{"ruleId":"88","severity":1,"message":"105","line":45,"column":35,"nodeType":"90","endLine":45,"endColumn":58,"suggestions":"106"},{"ruleId":"98","severity":1,"message":"107","line":30,"column":26,"nodeType":"100","messageId":"101","endLine":30,"endColumn":34},{"ruleId":"98","severity":1,"message":"108","line":30,"column":36,"nodeType":"100","messageId":"101","endLine":30,"endColumn":49},{"ruleId":"88","severity":1,"message":"109","line":99,"column":6,"nodeType":"90","endLine":99,"endColumn":13,"suggestions":"110"},{"ruleId":"88","severity":1,"message":"111","line":114,"column":6,"nodeType":"90","endLine":114,"endColumn":14,"suggestions":"112"},{"ruleId":"88","severity":1,"message":"111","line":125,"column":5,"nodeType":"90","endLine":125,"endColumn":17,"suggestions":"113"},{"ruleId":"84","replacedBy":"114"},{"ruleId":"86","replacedBy":"115"},"no-native-reassign",["116"],"no-negated-in-lhs",["117"],"react-hooks/exhaustive-deps","React Hook useCallback has an unnecessary dependency: 'token'. Either exclude it or remove the dependency array.","ArrayExpression",["118"],["119"],"@typescript-eslint/no-array-constructor","The array literal notation [] is preferable.","NewExpression","useLiteral",{"range":"120","text":"121"},"@typescript-eslint/no-unused-vars","'deletedItem' is assigned a value but never used.","Identifier","unusedVar","React Hook useCallback has a missing dependency: 'state'. Either include it or remove the dependency array. You can also do a functional update 'setState(s => ...)' if you only need 'state' in the 'setState' call.",["122"],["123"],"React Hook useEffect has a missing dependency: 'state'. Either include it or remove the dependency array. You can also do a functional update 'setState(s => ...)' if you only need 'state' in the 'setState' call.",["124"],"'deleting' is assigned a value but never used.","'savingPending' is assigned a value but never used.","React Hook useEffect has a missing dependency: 'pos'. Either include it or remove the dependency array. You can also replace multiple useState variables with useReducer if 'setApartmentsShow' needs the current value of 'pos'.",["125"],"React Hook useEffect has a missing dependency: 'items'. Either include it or remove the dependency array.",["126"],["127"],["116"],["117"],"no-global-assign","no-unsafe-negation",{"desc":"128","fix":"129"},{"desc":"128","fix":"130"},[6990,7001],"[]",{"desc":"131","fix":"132"},{"desc":"131","fix":"133"},{"desc":"134","fix":"135"},{"desc":"136","fix":"137"},{"desc":"138","fix":"139"},{"desc":"140","fix":"141"},"Update the dependencies array to be: []",{"range":"142","text":"121"},{"range":"143","text":"121"},"Update the dependencies array to be: [state]",{"range":"144","text":"145"},{"range":"146","text":"145"},"Update the dependencies array to be: [pendingAuthentication, state]",{"range":"147","text":"148"},"Update the dependencies array to be: [items, pos]",{"range":"149","text":"150"},"Update the dependencies array to be: [filter, items]",{"range":"151","text":"152"},"Update the dependencies array to be: [items, searchText]",{"range":"153","text":"154"},[4279,4286],[4356,4363],[1300,1302],"[state]",[1361,1363],[1401,1424],"[pendingAuthentication, state]",[2830,2837],"[items, pos]",[3250,3258],"[filter, items]",[3495,3507],"[items, searchText]"]